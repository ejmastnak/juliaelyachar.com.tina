---
import client from "@tina/__generated__/client";
import BaseLayout from "@/layouts/BaseLayout.astro";
import Events from "@tina/pages/Events/Index.tsx";
import { optimizeTinaImages } from '@/lib/optimizeTinaImages';

const content = await client.queries.myEventsPage({ relativePath: "index.json" });
const eventsResponse = await client.queries.eventConnection();
const head = content.data.eventsPage.head;

const events = eventsResponse.data.eventConnection.edges.map((edge) => edge.node);

await optimizeTinaImages(content, [
  {
    srcPath: ['data', 'eventsPage', 'img'],
    altPath: ['data', 'eventsPage', 'imgAlt'],
    width: 700,
  },
]);
---

<BaseLayout head={head}>
  <Events {...content} events={events} client:tina />
</BaseLayout>
